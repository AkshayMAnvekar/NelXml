module.exports=function(e){var o={};function r(t){if(o[t])return o[t].exports;var s=o[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=o,r.d=function(e,o,t){r.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,o){if(1&o&&(e=r(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var s in e)r.d(t,s,function(o){return e[o]}.bind(null,s));return t},r.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(o,"a",o),o},r.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},r.p="/dist/",r(r.s=3)}([function(e,o){e.exports=require("path")},function(e,o){e.exports=require("xlsx")},function(e,o){e.exports=require("fs")},function(e,o,r){r(4),e.exports=r(5)},function(e,o){e.exports=require("babel-polyfill")},function(e,o,r){const t=r(6),s=r(0),n=r(7),u=r(8),a=r(1),i=r(2),p=r(9).pd,c=r(10),l=t();l.use(n.urlencoded({extended:!1})),l.use(n.json());const d=process.cwd();l.use(t.static(s.join(d,"public"))),l.get("/test",(e,o)=>{o.send("My page")}),l.get("/test1",(e,o)=>{o.send("My page 2")}),l.get("/getfile",(e,o)=>{console.log(e.query),o.send("My page 2")}),l.post("/getfile",(e,o)=>{i.writeFileSync("./Output/req.json",e),i.writeFileSync("./Output/res.json",o),(new u.IncomingForm).parse(e).on("file",(async function(e,r){let t=a.readFile(`${r.path}`),s="",n="",u=t.SheetNames;for(let e of u)s=a.utils.sheet_to_json(t.Sheets[e],{defVal:""}),console.log(s),await c(s).then(e=>{n+=e,console.log("1",n)}),console.log("2",n);return n=JSON.parse(i.readFileSync("./Output/JSON.json")),o.send(p.json(JSON.stringify(n)))}))}),l.get("*",(e,o)=>{o.send("My web page")});const f=process.env.PORT||5e3;l.listen(f)},function(e,o){e.exports=require("express")},function(e,o){e.exports=require("body-parser")},function(e,o){e.exports=require("formidable")},function(e,o){e.exports=require("pretty-data")},function(e,o,r){const t=r(2);r(11),r(12),r(13),r(14),r(1),r(15),r(0);e.exports=async function(e){for(row of(console.log("Recieved",e),mcqq={type:"MCQ",correct_answer:0},baseJson={},section={},question={},marks={},qGroup=0,secCounter=0,qNo=0,headerJson={type:"header",content:[]},e)){if("ID"===row.Key.toUpperCase()&&(baseJson.id=row.Value),"TAGS"===row.Key.toUpperCase()&&(tags=[],row.Value.includes(",")?tags=row.Value.split(","):tags.push(row.Value),baseJson.tags=tags),"METADATA"===row.Key.toUpperCase()){if(metadata=[],row.Value.includes(","))for(b of(a=row.Value.split(","),a))c=b.split(":"),metaJson=`{"${c[0]}":"${c[1]}"}`,metadata.push(JSON.parse(metaJson));else a=row.Value.split(":"),metaJson=`{"${a[0]}":"${a[1]}"}`,metadata.push(JSON.parse(metaJson));baseJson.metadata=metadata}"TITLE"===row.Key.toUpperCase()&&(baseJson.title=void 0!==row.Value&&"FALSE"!==row.Value.toUpperCase()&&row.Value,baseJson.content=[]),"HEADER"===row.Key.toUpperCase()&&(row.Value.includes(".jpg")||row.Value.includes(".png")?row.Value.includes(",")?(header={type:"images-group"},a=row.Value.split(","),header.images=a,headerJson.content.push(header)):(header={type:"image"},header.image=row.Value,headerJson.content.push(header)):(header={type:"text"},header.text=row.Value,headerJson.content.push(header))),"QUESTIONTYPE"===row.Key.toUpperCase()&&(qGroup=row.Group,++qNo,question.hasOwnProperty(qGroup)||(question[`${qGroup}`]={}),row.Value.toUpperCase().includes("MCQ")?question[`${qGroup}`][`${qNo}`]={type:`${row.Value}`}:question[`${qGroup}`][`${qNo}`]={type:`${row.Value}`,lines:1}),"QUESTION"===row.Key.toUpperCase()&&(question[`${qGroup}`][`${qNo}`].prompt=row.Value),/C\d/.test(row.Key.toUpperCase())&&(question[`${qGroup}`][`${qNo}`].hasOwnProperty("options")||(question[`${qGroup}`][`${qNo}`].options=[]),question[`${qGroup}`][`${qNo}`].options.push(row.Value)),"ANSWER"===row.Key.toUpperCase()&&(question[`${qGroup}`][`${qNo}`].correct_answer=row.Value-1),"MARKS"===row.Key.toUpperCase()&&(marks.hasOwnProperty(qGroup)||(marks[`${qGroup}`]={}),marks[`${qGroup}`][`${qNo}`]=row.Value),"SECTION"===row.Key.toUpperCase()&&void 0!==row.Group&&(++secCounter,row.Group>1&&(marks.hasOwnProperty("1")||(marks[1]={}),marks[1][`${qNo+1}`]=!1),section[`${row.Group}`]={type:"assembly",prompt:!1,marks:[],questions:[]},row.Value&&(section[`${row.Group}`].prompt=row.Value))}for(console.log(secCounter),i=secCounter;i>1;i--)for(var o in question[secCounter])section[i].marks.push(marks[i][o]),section[i].questions.push(question[secCounter][o]);for(j in marks[1])secC=2,"number"==typeof marks[1][j]?(section[1].marks.push(marks[1][j]),section[1].questions.push(question[1][j])):"boolean"==typeof marks[1][j]?(console.log("Test3",section[secC]),section[1].marks.push(marks[1][j]),section[1].questions.push(section[secC]),++secC):"string"==typeof marks[1][j]&&console.log("Test3",j);return console.log("Section: ",section),baseJson.content.push(headerJson),baseJson.content.push(section[1]),t.writeFileSync("./Output/JSON.json",JSON.stringify(baseJson)),"./Output/JSON.json"}},function(e,o){e.exports=require("xml2js")},function(e,o){e.exports=require("excel4node")},function(e,o){e.exports=require("adm-zip")},function(e,o){e.exports=require("exceljs")},function(e,o){e.exports=require("string-similarity")}]);