module.exports=function(e){var o={};function t(r){if(o[r])return o[r].exports;var s=o[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=o,t.d=function(e,o,r){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var s in e)t.d(r,s,function(o){return e[o]}.bind(null,s));return r},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="/dist/",t(t.s=3)}([function(e,o){e.exports=require("path")},function(e,o){e.exports=require("fs")},function(e,o){e.exports=require("xlsx")},function(e,o,t){t(4),e.exports=t(5)},function(e,o){e.exports=require("babel-polyfill")},function(e,o,t){const r=t(6),s=t(0),a=t(7),n=t(8),u=t(2),p=t(1);var i=t(9);const l=t(10).pd,c=t(11),m=t(17),d=r();d.use(a.urlencoded({extended:!1})),d.use(a.json());const w=process.cwd();d.use(r.static(s.join(w,"public"))),d.get("/test",(e,o)=>{o.send("My page")}),d.get("/test1",(e,o)=>{o.send("My page 2")}),d.get("/getfile",(e,o)=>{console.log(e.query),o.send("My page 2")}),d.post("/getfile",(e,o)=>{(new n.IncomingForm).parse(e).on("file",(async function(e,t){let r=u.readFile(`${t.path}`),s="",a={},n=r.SheetNames;var d=0;await m("./Output/JSONS"),async function(e){new Promise(o=>setTimeout(o,e))}(1e3);for(let e of n)s=u.utils.sheet_to_json(r.Sheets[e],{defVal:""}),console.log(s),await c(s).then(o=>{++d,a[d]=o,console.log("1",a),p.writeFileSync(`./Output/JSONS/${e}.json`,l.json(JSON.stringify(baseJson)))});var w=p.createWriteStream("./public/Output.zip"),y=i("zip",{zlib:{level:9}});return y.pipe(w),y.directory("./Output/JSONS",!1),y.finalize(),o.send(JSON.stringify(a))}))}),d.get("*",(e,o)=>{o.send("My web page")});const y=process.env.PORT||3e3;d.listen(y)},function(e,o){e.exports=require("express")},function(e,o){e.exports=require("body-parser")},function(e,o){e.exports=require("formidable")},function(e,o){e.exports=require("archiver")},function(e,o){e.exports=require("pretty-data")},function(e,o,t){const r=t(1);t(12),t(13),t(14),t(15),t(2),t(16),t(0);e.exports=async function(e){for(row of(mcqq={type:"MCQ",correct_answer:0},baseJson={},section={},question={},marks={},interludes={},qGroup=0,secCounter=0,qNo=0,headerJson={type:"header",content:[]},metadata=[],e)){if("ID"===row.Key.toUpperCase()&&(baseJson.id=row.Value),"TAGS"===row.Key.toUpperCase()&&(tags=[],row.Value.includes(",")?tags=row.Value.split(","):tags.push(row.Value),baseJson.tags=tags,baseJson.metadata=metadata),console.log("upper test"),"METADATA"===row.Key.toUpperCase()){if(row.Value.includes(","))for(b of(a=row.Value.split(","),a))c=b.split(":"),metaJson=`{"${c[0]}":"${c[1]}"}`,metadata.push(JSON.parse(metaJson));else a=row.Value.split(":"),metaJson=`{"${a[0]}":"${a[1]}"}`,metadata.push(JSON.parse(metaJson));baseJson.metadata=metadata}"TITLE"===row.Key.toUpperCase()&&(baseJson.title=void 0!==row.Value&&"FALSE"!==row.Value.toUpperCase()&&row.Value,baseJson.content=[]),"HEADER"===row.Key.toUpperCase()&&(row.Value.includes(".jpg")||row.Value.includes(".png")||row.Value.includes(".JPG")||row.Value.includes(".PNG")?row.Value.includes(",")?(header={type:"image-group"},a=row.Value.split(","),header.images=a,headerJson.content.push(header)):(header={type:"image"},header.image=row.Value,headerJson.content.push(header)):(header={type:"text"},header.text=row.Value,headerJson.content.push(header))),"QTYPE"===row.Key.toUpperCase()&&(row.Group?qGroup=row.Group:qGroup=0,++qNo,question.hasOwnProperty(qGroup)||(question[`${qGroup}`]={}),row.Value.toUpperCase().includes("MCQ")?question[`${qGroup}`][`${qNo}`]={type:`${row.Value}`}:question[`${qGroup}`][`${qNo}`]={type:`${row.Value}`,lines:1}),"QUESTION"===row.Key.toUpperCase()&&(question[`${qGroup}`][`${qNo}`].prompt=row.Value),"LINES"===row.Key.toUpperCase()&&(question[`${qGroup}`][`${qNo}`].lines=row.Value),/C\d/.test(row.Key.toUpperCase())&&(question[`${qGroup}`][`${qNo}`].hasOwnProperty("options")||(question[`${qGroup}`][`${qNo}`].options=[]),question[`${qGroup}`][`${qNo}`].options.push(row.Value)),"ANSWER"===row.Key.toUpperCase()&&question[`${qGroup}`][`${qNo}`].type.includes("MCQ")&&(question[`${qGroup}`][`${qNo}`].correct_answer=row.Value-1),"GLOBALLYUNIQUEID"===row.Key.toUpperCase()&&(metaJson=`{"globallyUniqueId":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"STUDYDESIGNYEAR"===row.Key.toUpperCase()&&(metaJson=`{"studyDesignYear":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"YEARLEVEL"===row.Key.toUpperCase()&&(metaJson=`{"yearLevel":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"CREATEDBY"===row.Key.toUpperCase()&&(metaJson=`{"createdBy":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"QUESTIONTYPE"===row.Key.toUpperCase()&&(metaJson=`{"questionType":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"COURSE"===row.Key.toUpperCase()&&(metaJson=`{"course":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"SUBJECT"===row.Key.toUpperCase()&&(metaJson=`{"subject":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"VCAAREFERENCE"===row.Key.toUpperCase()&&(metaJson=`{"vcaaReference":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"DIFFICULTY"===row.Key.toUpperCase()&&(metaJson=`{"difficulty":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"TIME"===row.Key.toUpperCase()&&(metaJson=`{"time":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"TMARKS"===row.Key.toUpperCase()&&(metaJson=`{"marks":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"YEARGENERATED"===row.Key.toUpperCase()&&(metaJson=`{"yearGenerated":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"STATE"===row.Key.toUpperCase()&&(metaJson=`{"state":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"ONLINEEXAM"===row.Key.toUpperCase()&&(metaJson=`{"onlineExam":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"PRINTABLE"===row.Key.toUpperCase()&&(metaJson=`{"printable":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"TEACHERONLY"===row.Key.toUpperCase()&&(metaJson=`{"teacherOnly":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"TRIALQUESTION"===row.Key.toUpperCase()&&(metaJson=`{"trialQuestion":"${row.Value}"}`,metadata.push(JSON.parse(metaJson))),"LINESPRINTED"===row.Key.toUpperCase()&&(metaJson=`{"linesPrinted":"${void 0!==row.Value?row.Value:0}"}`,metadata.push(JSON.parse(metaJson))),"MARKS"===row.Key.toUpperCase()&&(marks.hasOwnProperty(qGroup)||(marks[`${qGroup}`]={}),marks[`${qGroup}`][`${qNo}`]=row.Value),"QHEADER"===row.Key.toUpperCase()&&(interludes.hasOwnProperty(qGroup)||(interludes[`${qGroup}`]={}),interludes[`${qGroup}`][`${qNo}`]=row.Value),"SECTION"===row.Key.toUpperCase()&&void 0!==row.Group&&(++secCounter,row.Group>1&&(marks.hasOwnProperty("1")||(marks[1]={}),marks[1][`${qNo+1}`]=!1),section[`${row.Group}`]={type:"assembly",prompt:!1,marks:[],interludes:[],questions:[]},row.Value&&(section[`${row.Group}`].prompt=row.Value))}if(console.log(secCounter),section[1]){for(i=secCounter;i>1;i--)for(var o in question[secCounter])section[i].marks.push(marks[i][o]),section[i].questions.push(question[secCounter][o]);for(j in marks[1])secC=2,"number"==typeof marks[1][j]?(section[1].marks.push(marks[1][j]),section[1].questions.push(question[1][j])):"boolean"==typeof marks[1][j]?(console.log("Test3",section[secC]),section[1].marks.push(marks[1][j]),section[1].questions.push(section[secC]),++secC):"string"==typeof marks[1][j]&&console.log("Test3",j)}if(baseJson.content.push(headerJson),question[0])for(o in question[0])baseJson.content.push(question[0][o]);return section[1]&&baseJson.content.push(section[1]),r.writeFileSync("./Output/JSON.json",JSON.stringify(baseJson)),baseJson}},function(e,o){e.exports=require("xml2js")},function(e,o){e.exports=require("excel4node")},function(e,o){e.exports=require("adm-zip")},function(e,o){e.exports=require("exceljs")},function(e,o){e.exports=require("string-similarity")},function(e,o,t){const r=t(1),s=t(0);e.exports=async function(e){r.readdir(e,(o,t)=>{if(o)throw o;for(const o of t)r.unlink(s.join(e,o),e=>{if(e)throw e})})}}]);